---

- name: Explore
  hosts: rnodes
  become: yes
  vars_files:
    - priv/vault1.yml
  tasks:
    - name: ping
      ping:
    - name: Explore Disks
      shell: df -h
      register: disk_usage
    - name: Show disk info
      debug: msg="{{ disk_usage.stdout_lines }}"
    - debug: var=ansible_devices
    - debug: var=ansible_memory_mb
    - debug: var=ansible_processor
    - debug: var=ansible_processor_cores
    - debug: msg="total RAM is {{ ansible_memory_mb.real.total }} MB"
    - fail: msg="not enough RAM - 32GB needed"
      when: ansible_memory_mb.real.total < 32000
    - name: update apt packages
      apt: update_cache=yes cache_valid_time=3600
